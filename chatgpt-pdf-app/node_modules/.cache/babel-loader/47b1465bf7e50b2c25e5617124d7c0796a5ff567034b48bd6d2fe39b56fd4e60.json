{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useTranslationContext } from '../../../context';\nimport { MediaRecorderController } from '../classes';\nexport var useMediaRecorder = function (_a) {\n  var asyncMessagesMultiSendEnabled = _a.asyncMessagesMultiSendEnabled,\n    enabled = _a.enabled,\n    generateRecordingTitle = _a.generateRecordingTitle,\n    handleSubmit = _a.handleSubmit,\n    recordingConfig = _a.recordingConfig,\n    uploadAttachment = _a.uploadAttachment;\n  var t = useTranslationContext('useMediaRecorder').t;\n  var _b = useState(),\n    recording = _b[0],\n    setRecording = _b[1];\n  var _c = useState(),\n    recordingState = _c[0],\n    setRecordingState = _c[1];\n  var _d = useState(),\n    permissionState = _d[0],\n    setPermissionState = _d[1];\n  var _e = useState(false),\n    isScheduledForSubmit = _e[0],\n    scheduleForSubmit = _e[1];\n  var recorder = useMemo(function () {\n    return enabled ? new MediaRecorderController({\n      config: recordingConfig !== null && recordingConfig !== void 0 ? recordingConfig : {},\n      generateRecordingTitle: generateRecordingTitle,\n      t: t\n    }) : undefined;\n  }, [recordingConfig, enabled, generateRecordingTitle, t]);\n  var completeRecording = useCallback(function () {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var recording;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!recorder) return [2 /*return*/];\n            return [4 /*yield*/, recorder.stop()];\n          case 1:\n            recording = _a.sent();\n            if (!recording) return [2 /*return*/];\n            return [4 /*yield*/, uploadAttachment(recording)];\n          case 2:\n            _a.sent();\n            if (!asyncMessagesMultiSendEnabled) {\n              // FIXME: cannot call handleSubmit() directly as the function has stale reference to attachments\n              scheduleForSubmit(true);\n            }\n            recorder.cleanUp();\n            return [2 /*return*/];\n        }\n      });\n    });\n  }, [asyncMessagesMultiSendEnabled, recorder, uploadAttachment]);\n  useEffect(function () {\n    if (!isScheduledForSubmit) return;\n    handleSubmit();\n    scheduleForSubmit(false);\n  }, [handleSubmit, isScheduledForSubmit]);\n  useEffect(function () {\n    if (!recorder) return;\n    recorder.permission.watch();\n    var recordingSubscription = recorder.recording.subscribe(setRecording);\n    var recordingStateSubscription = recorder.recordingState.subscribe(setRecordingState);\n    var permissionStateSubscription = recorder.permission.state.subscribe(setPermissionState);\n    return function () {\n      recorder.cancel();\n      recorder.permission.unwatch();\n      recordingSubscription.unsubscribe();\n      recordingStateSubscription.unsubscribe();\n      permissionStateSubscription.unsubscribe();\n    };\n  }, [recorder]);\n  return {\n    completeRecording: completeRecording,\n    permissionState: permissionState,\n    recorder: recorder,\n    recording: recording,\n    recordingState: recordingState\n  };\n};","map":{"version":3,"names":["__awaiter","__generator","useCallback","useEffect","useMemo","useState","useTranslationContext","MediaRecorderController","useMediaRecorder","_a","asyncMessagesMultiSendEnabled","enabled","generateRecordingTitle","handleSubmit","recordingConfig","uploadAttachment","t","_b","recording","setRecording","_c","recordingState","setRecordingState","_d","permissionState","setPermissionState","_e","isScheduledForSubmit","scheduleForSubmit","recorder","config","undefined","completeRecording","label","stop","sent","cleanUp","permission","watch","recordingSubscription","subscribe","recordingStateSubscription","permissionStateSubscription","state","cancel","unwatch","unsubscribe"],"sources":["C:/Users/Aniket/Desktop/MS/NCSU/Subjects/Infinitus/chatgpt-pdf-app/node_modules/stream-chat-react/dist/components/MediaRecorder/hooks/useMediaRecorder.js"],"sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useTranslationContext } from '../../../context';\nimport { MediaRecorderController } from '../classes';\nexport var useMediaRecorder = function (_a) {\n    var asyncMessagesMultiSendEnabled = _a.asyncMessagesMultiSendEnabled, enabled = _a.enabled, generateRecordingTitle = _a.generateRecordingTitle, handleSubmit = _a.handleSubmit, recordingConfig = _a.recordingConfig, uploadAttachment = _a.uploadAttachment;\n    var t = useTranslationContext('useMediaRecorder').t;\n    var _b = useState(), recording = _b[0], setRecording = _b[1];\n    var _c = useState(), recordingState = _c[0], setRecordingState = _c[1];\n    var _d = useState(), permissionState = _d[0], setPermissionState = _d[1];\n    var _e = useState(false), isScheduledForSubmit = _e[0], scheduleForSubmit = _e[1];\n    var recorder = useMemo(function () {\n        return enabled\n            ? new MediaRecorderController({\n                config: recordingConfig !== null && recordingConfig !== void 0 ? recordingConfig : {},\n                generateRecordingTitle: generateRecordingTitle,\n                t: t,\n            })\n            : undefined;\n    }, [recordingConfig, enabled, generateRecordingTitle, t]);\n    var completeRecording = useCallback(function () { return __awaiter(void 0, void 0, void 0, function () {\n        var recording;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (!recorder)\n                        return [2 /*return*/];\n                    return [4 /*yield*/, recorder.stop()];\n                case 1:\n                    recording = _a.sent();\n                    if (!recording)\n                        return [2 /*return*/];\n                    return [4 /*yield*/, uploadAttachment(recording)];\n                case 2:\n                    _a.sent();\n                    if (!asyncMessagesMultiSendEnabled) {\n                        // FIXME: cannot call handleSubmit() directly as the function has stale reference to attachments\n                        scheduleForSubmit(true);\n                    }\n                    recorder.cleanUp();\n                    return [2 /*return*/];\n            }\n        });\n    }); }, [asyncMessagesMultiSendEnabled, recorder, uploadAttachment]);\n    useEffect(function () {\n        if (!isScheduledForSubmit)\n            return;\n        handleSubmit();\n        scheduleForSubmit(false);\n    }, [handleSubmit, isScheduledForSubmit]);\n    useEffect(function () {\n        if (!recorder)\n            return;\n        recorder.permission.watch();\n        var recordingSubscription = recorder.recording.subscribe(setRecording);\n        var recordingStateSubscription = recorder.recordingState.subscribe(setRecordingState);\n        var permissionStateSubscription = recorder.permission.state.subscribe(setPermissionState);\n        return function () {\n            recorder.cancel();\n            recorder.permission.unwatch();\n            recordingSubscription.unsubscribe();\n            recordingStateSubscription.unsubscribe();\n            permissionStateSubscription.unsubscribe();\n        };\n    }, [recorder]);\n    return {\n        completeRecording: completeRecording,\n        permissionState: permissionState,\n        recorder: recorder,\n        recording: recording,\n        recordingState: recordingState,\n    };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}