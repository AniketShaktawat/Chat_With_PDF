{"ast":null,"code":"import { __assign, __spreadArray } from \"tslib\";\nimport { useCallback, useReducer, useState } from 'react';\nimport { nanoid } from 'nanoid';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useAttachments } from './useAttachments';\nimport { useLinkPreviews } from './useLinkPreviews';\nimport { useMessageInputText } from './useMessageInputText';\nimport { useSubmitHandler } from './useSubmitHandler';\nimport { usePasteHandler } from './usePasteHandler';\nimport { useMediaRecorder } from '../../MediaRecorder/hooks/useMediaRecorder';\nimport { LinkPreviewState, SetLinkPreviewMode } from '../types';\nimport { mergeDeep } from '../../../utils/mergeDeep';\nvar makeEmptyMessageInputState = function () {\n  return {\n    attachments: [],\n    fileOrder: [],\n    fileUploads: {},\n    imageOrder: [],\n    imageUploads: {},\n    linkPreviews: new Map(),\n    mentioned_users: [],\n    setText: function () {\n      return null;\n    },\n    text: ''\n  };\n};\n/**\n * Initializes the state. Empty if the message prop is falsy.\n */\nvar initState = function (message) {\n  var _a, _b, _c, _d, _e, _f, _g;\n  if (!message) {\n    return makeEmptyMessageInputState();\n  }\n  // if message prop is defined, get image uploads, file uploads, text, etc.\n  var imageUploads = (_b = (_a = message.attachments) === null || _a === void 0 ? void 0 : _a.filter(function (_a) {\n    var type = _a.type;\n    return type === 'image';\n  }).reduce(function (acc, _a) {\n    var author_name = _a.author_name,\n      _b = _a.fallback,\n      fallback = _b === void 0 ? '' : _b,\n      image_url = _a.image_url,\n      og_scrape_url = _a.og_scrape_url,\n      text = _a.text,\n      title = _a.title,\n      title_link = _a.title_link;\n    var id = nanoid();\n    acc[id] = {\n      author_name: author_name,\n      file: {\n        name: fallback\n      },\n      id: id,\n      og_scrape_url: og_scrape_url,\n      state: 'finished',\n      text: text,\n      title: title,\n      title_link: title_link,\n      url: image_url\n    };\n    return acc;\n  }, {})) !== null && _b !== void 0 ? _b : {};\n  var fileUploads = (_d = (_c = message.attachments) === null || _c === void 0 ? void 0 : _c.filter(function (_a) {\n    var type = _a.type;\n    return type === 'file';\n  }).reduce(function (acc, _a) {\n    var asset_url = _a.asset_url,\n      file_size = _a.file_size,\n      mime_type = _a.mime_type,\n      thumb_url = _a.thumb_url,\n      _b = _a.title,\n      title = _b === void 0 ? '' : _b;\n    var id = nanoid();\n    acc[id] = {\n      file: {\n        name: title,\n        size: file_size,\n        type: mime_type\n      },\n      id: id,\n      state: 'finished',\n      thumb_url: thumb_url,\n      url: asset_url\n    };\n    return acc;\n  }, {})) !== null && _d !== void 0 ? _d : {};\n  var linkPreviews = (_f = (_e = message.attachments) === null || _e === void 0 ? void 0 : _e.reduce(function (acc, attachment) {\n    if (!attachment.og_scrape_url) return acc;\n    acc.set(attachment.og_scrape_url, __assign(__assign({}, attachment), {\n      state: LinkPreviewState.LOADED\n    }));\n    return acc;\n  }, new Map())) !== null && _f !== void 0 ? _f : new Map();\n  var imageOrder = Object.keys(imageUploads);\n  var fileOrder = Object.keys(fileUploads);\n  var attachments = ((_g = message.attachments) === null || _g === void 0 ? void 0 : _g.filter(function (_a) {\n    var type = _a.type;\n    return type !== 'file' && type !== 'image';\n  }).map(function (att) {\n    return __assign(__assign({}, att), {\n      $internal: {\n        id: nanoid(),\n        uploadState: 'finished'\n      }\n    });\n  })) || [];\n  var mentioned_users = message.mentioned_users || [];\n  return {\n    attachments: attachments,\n    fileOrder: fileOrder,\n    fileUploads: fileUploads,\n    imageOrder: imageOrder,\n    imageUploads: imageUploads,\n    linkPreviews: linkPreviews,\n    mentioned_users: mentioned_users,\n    setText: function () {\n      return null;\n    },\n    text: message.text || ''\n  };\n};\n/**\n * MessageInput state reducer\n */\nvar messageInputReducer = function (state, action) {\n  var _a, _b;\n  var _c;\n  switch (action.type) {\n    case 'setText':\n      return __assign(__assign({}, state), {\n        text: action.getNewText(state.text)\n      });\n    case 'clear':\n      return makeEmptyMessageInputState();\n    case 'upsertAttachment':\n      {\n        var attachmentIndex = state.attachments.findIndex(function (att) {\n          var _a, _b, _c;\n          return ((_a = att.$internal) === null || _a === void 0 ? void 0 : _a.id) && ((_b = att.$internal) === null || _b === void 0 ? void 0 : _b.id) === ((_c = action.attachment.$internal) === null || _c === void 0 ? void 0 : _c.id);\n        });\n        var upsertedAttachment = mergeDeep((_c = state.attachments[attachmentIndex]) !== null && _c !== void 0 ? _c : {}, action.attachment);\n        var attachments = __spreadArray([], state.attachments, true);\n        attachments.splice(attachmentIndex, 1, upsertedAttachment);\n        return __assign(__assign({}, state), {\n          attachments: attachments\n        });\n      }\n    case 'removeAttachment':\n      {\n        var attachmentIndex = state.attachments.findIndex(function (att) {\n          var _a, _b;\n          return ((_a = att.$internal) === null || _a === void 0 ? void 0 : _a.id) && ((_b = att.$internal) === null || _b === void 0 ? void 0 : _b.id) === action.id;\n        });\n        if (attachmentIndex === -1) return state;\n        return __assign(__assign({}, state), {\n          attachments: __spreadArray([], state.attachments.splice(attachmentIndex, 1), true)\n        });\n      }\n    case 'setImageUpload':\n      {\n        var imageAlreadyExists = state.imageUploads[action.id];\n        if (!imageAlreadyExists && !action.file) return state;\n        var imageOrder = imageAlreadyExists ? state.imageOrder : state.imageOrder.concat(action.id);\n        var newUploadFields = __assign({}, action);\n        delete newUploadFields.type;\n        return __assign(__assign({}, state), {\n          imageOrder: imageOrder,\n          imageUploads: __assign(__assign({}, state.imageUploads), (_a = {}, _a[action.id] = __assign(__assign({}, state.imageUploads[action.id]), newUploadFields), _a))\n        });\n      }\n    case 'setFileUpload':\n      {\n        var fileAlreadyExists = state.fileUploads[action.id];\n        if (!fileAlreadyExists && !action.file) return state;\n        var fileOrder = fileAlreadyExists ? state.fileOrder : state.fileOrder.concat(action.id);\n        var newUploadFields = __assign({}, action);\n        delete newUploadFields.type;\n        return __assign(__assign({}, state), {\n          fileOrder: fileOrder,\n          fileUploads: __assign(__assign({}, state.fileUploads), (_b = {}, _b[action.id] = __assign(__assign({}, state.fileUploads[action.id]), newUploadFields), _b))\n        });\n      }\n    case 'setLinkPreviews':\n      {\n        var linkPreviews_1 = new Map(state.linkPreviews);\n        if (action.mode === SetLinkPreviewMode.REMOVE) {\n          Array.from(action.linkPreviews.keys()).forEach(function (key) {\n            linkPreviews_1.delete(key);\n          });\n        } else {\n          Array.from(action.linkPreviews.values()).reduce(function (acc, linkPreview) {\n            var existingPreview = acc.get(linkPreview.og_scrape_url);\n            var alreadyEnqueued = linkPreview.state === LinkPreviewState.QUEUED && (existingPreview === null || existingPreview === void 0 ? void 0 : existingPreview.state) !== LinkPreviewState.FAILED;\n            if (existingPreview && alreadyEnqueued) return acc;\n            acc.set(linkPreview.og_scrape_url, linkPreview);\n            return acc;\n          }, linkPreviews_1);\n          if (action.mode === SetLinkPreviewMode.SET) {\n            Array.from(state.linkPreviews.keys()).forEach(function (key) {\n              if (!action.linkPreviews.get(key)) linkPreviews_1.delete(key);\n            });\n          }\n        }\n        return __assign(__assign({}, state), {\n          linkPreviews: linkPreviews_1\n        });\n      }\n    case 'removeImageUpload':\n      {\n        if (!state.imageUploads[action.id]) return state; // cannot remove anything\n        var newImageUploads = __assign({}, state.imageUploads);\n        delete newImageUploads[action.id];\n        return __assign(__assign({}, state), {\n          imageOrder: state.imageOrder.filter(function (_id) {\n            return _id !== action.id;\n          }),\n          imageUploads: newImageUploads\n        });\n      }\n    case 'removeFileUpload':\n      {\n        if (!state.fileUploads[action.id]) return state; // cannot remove anything\n        var newFileUploads = __assign({}, state.fileUploads);\n        delete newFileUploads[action.id];\n        return __assign(__assign({}, state), {\n          fileOrder: state.fileOrder.filter(function (_id) {\n            return _id !== action.id;\n          }),\n          fileUploads: newFileUploads\n        });\n      }\n    case 'addMentionedUser':\n      return __assign(__assign({}, state), {\n        mentioned_users: state.mentioned_users.concat(action.user)\n      });\n    default:\n      return state;\n  }\n};\n/**\n * hook for MessageInput state\n */\nexport var useMessageInputState = function (props) {\n  var _a;\n  var additionalTextareaProps = props.additionalTextareaProps,\n    asyncMessagesMultiSendEnabled = props.asyncMessagesMultiSendEnabled,\n    audioRecordingConfig = props.audioRecordingConfig,\n    audioRecordingEnabled = props.audioRecordingEnabled,\n    getDefaultValue = props.getDefaultValue,\n    message = props.message,\n    urlEnrichmentConfig = props.urlEnrichmentConfig;\n  var _b = useChannelStateContext('useMessageInputState'),\n    _c = _b.channelCapabilities,\n    channelCapabilities = _c === void 0 ? {} : _c,\n    channelConfig = _b.channelConfig,\n    enrichURLForPreviewChannelContext = _b.enrichURLForPreview;\n  var defaultValue = (getDefaultValue === null || getDefaultValue === void 0 ? void 0 : getDefaultValue()) || (additionalTextareaProps === null || additionalTextareaProps === void 0 ? void 0 : additionalTextareaProps.defaultValue);\n  var initialStateValue = message || (Array.isArray(defaultValue) ? {\n    text: defaultValue.join('')\n  } : {\n    text: defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.toString()\n  });\n  var _d = useReducer(messageInputReducer, initialStateValue, initState),\n    state = _d[0],\n    dispatch = _d[1];\n  var enrichURLsController = useLinkPreviews(__assign(__assign({\n    dispatch: dispatch,\n    linkPreviews: state.linkPreviews\n  }, urlEnrichmentConfig), {\n    enrichURLForPreview: (_a = urlEnrichmentConfig === null || urlEnrichmentConfig === void 0 ? void 0 : urlEnrichmentConfig.enrichURLForPreview) !== null && _a !== void 0 ? _a : enrichURLForPreviewChannelContext\n  }));\n  var _e = useMessageInputText(props, state, dispatch, enrichURLsController.findAndEnqueueURLsToEnrich),\n    handleChange = _e.handleChange,\n    insertText = _e.insertText,\n    textareaRef = _e.textareaRef;\n  var _f = useState(false),\n    showCommandsList = _f[0],\n    setShowCommandsList = _f[1];\n  var _g = useState(false),\n    showMentionsList = _g[0],\n    setShowMentionsList = _g[1];\n  var openCommandsList = function () {\n    dispatch({\n      getNewText: function () {\n        return '/';\n      },\n      type: 'setText'\n    });\n    setShowCommandsList(true);\n  };\n  var closeCommandsList = function () {\n    return setShowCommandsList(false);\n  };\n  var openMentionsList = function () {\n    dispatch({\n      getNewText: function (currentText) {\n        return currentText + '@';\n      },\n      type: 'setText'\n    });\n    setShowMentionsList(true);\n  };\n  var closeMentionsList = function () {\n    return setShowMentionsList(false);\n  };\n  var _h = useAttachments(props, state, dispatch, textareaRef),\n    maxFilesLeft = _h.maxFilesLeft,\n    numberOfUploads = _h.numberOfUploads,\n    removeAttachment = _h.removeAttachment,\n    removeFile = _h.removeFile,\n    removeImage = _h.removeImage,\n    uploadAttachment = _h.uploadAttachment,\n    uploadFile = _h.uploadFile,\n    uploadImage = _h.uploadImage,\n    uploadNewFiles = _h.uploadNewFiles;\n  var handleSubmit = useSubmitHandler(props, state, dispatch, numberOfUploads, enrichURLsController).handleSubmit;\n  var recordingController = useMediaRecorder({\n    asyncMessagesMultiSendEnabled: asyncMessagesMultiSendEnabled,\n    enabled: !!audioRecordingEnabled,\n    handleSubmit: handleSubmit,\n    recordingConfig: audioRecordingConfig,\n    uploadAttachment: uploadAttachment\n  });\n  // todo: remove the check for channelConfig?.uploads\n  var isUploadEnabled = (channelConfig === null || channelConfig === void 0 ? void 0 : channelConfig.uploads) !== false && channelCapabilities['upload-file'] !== false;\n  var onPaste = usePasteHandler(uploadNewFiles, insertText, isUploadEnabled, enrichURLsController.findAndEnqueueURLsToEnrich).onPaste;\n  var onSelectUser = useCallback(function (item) {\n    dispatch({\n      type: 'addMentionedUser',\n      user: item\n    });\n  }, []);\n  var setText = useCallback(function (text) {\n    dispatch({\n      getNewText: function () {\n        return text;\n      },\n      type: 'setText'\n    });\n  }, []);\n  return __assign(__assign(__assign({}, state), enrichURLsController), {\n    closeCommandsList: closeCommandsList,\n    closeMentionsList: closeMentionsList,\n    handleChange: handleChange,\n    handleSubmit: handleSubmit,\n    insertText: insertText,\n    isUploadEnabled: isUploadEnabled,\n    maxFilesLeft: maxFilesLeft,\n    numberOfUploads: numberOfUploads,\n    onPaste: onPaste,\n    onSelectUser: onSelectUser,\n    openCommandsList: openCommandsList,\n    openMentionsList: openMentionsList,\n    recordingController: recordingController,\n    removeAttachment: removeAttachment,\n    removeFile: removeFile,\n    removeImage: removeImage,\n    setText: setText,\n    showCommandsList: showCommandsList,\n    showMentionsList: showMentionsList,\n    textareaRef: textareaRef,\n    uploadAttachment: uploadAttachment,\n    uploadFile: uploadFile,\n    uploadImage: uploadImage,\n    uploadNewFiles: uploadNewFiles\n  });\n};","map":{"version":3,"names":["__assign","__spreadArray","useCallback","useReducer","useState","nanoid","useChannelStateContext","useAttachments","useLinkPreviews","useMessageInputText","useSubmitHandler","usePasteHandler","useMediaRecorder","LinkPreviewState","SetLinkPreviewMode","mergeDeep","makeEmptyMessageInputState","attachments","fileOrder","fileUploads","imageOrder","imageUploads","linkPreviews","Map","mentioned_users","setText","text","initState","message","_a","_b","_c","_d","_e","_f","_g","filter","type","reduce","acc","author_name","fallback","image_url","og_scrape_url","title","title_link","id","file","name","state","url","asset_url","file_size","mime_type","thumb_url","size","attachment","set","LOADED","Object","keys","map","att","$internal","uploadState","messageInputReducer","action","getNewText","attachmentIndex","findIndex","upsertedAttachment","splice","imageAlreadyExists","concat","newUploadFields","fileAlreadyExists","linkPreviews_1","mode","REMOVE","Array","from","forEach","key","delete","values","linkPreview","existingPreview","get","alreadyEnqueued","QUEUED","FAILED","SET","newImageUploads","_id","newFileUploads","user","useMessageInputState","props","additionalTextareaProps","asyncMessagesMultiSendEnabled","audioRecordingConfig","audioRecordingEnabled","getDefaultValue","urlEnrichmentConfig","channelCapabilities","channelConfig","enrichURLForPreviewChannelContext","enrichURLForPreview","defaultValue","initialStateValue","isArray","join","toString","dispatch","enrichURLsController","findAndEnqueueURLsToEnrich","handleChange","insertText","textareaRef","showCommandsList","setShowCommandsList","showMentionsList","setShowMentionsList","openCommandsList","closeCommandsList","openMentionsList","currentText","closeMentionsList","_h","maxFilesLeft","numberOfUploads","removeAttachment","removeFile","removeImage","uploadAttachment","uploadFile","uploadImage","uploadNewFiles","handleSubmit","recordingController","enabled","recordingConfig","isUploadEnabled","uploads","onPaste","onSelectUser","item"],"sources":["C:/Users/Aniket/Desktop/MS/NCSU/Subjects/Infinitus/chatgpt-pdf-app/node_modules/stream-chat-react/dist/components/MessageInput/hooks/useMessageInputState.js"],"sourcesContent":["import { __assign, __spreadArray } from \"tslib\";\nimport { useCallback, useReducer, useState } from 'react';\nimport { nanoid } from 'nanoid';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useAttachments } from './useAttachments';\nimport { useLinkPreviews } from './useLinkPreviews';\nimport { useMessageInputText } from './useMessageInputText';\nimport { useSubmitHandler } from './useSubmitHandler';\nimport { usePasteHandler } from './usePasteHandler';\nimport { useMediaRecorder } from '../../MediaRecorder/hooks/useMediaRecorder';\nimport { LinkPreviewState, SetLinkPreviewMode } from '../types';\nimport { mergeDeep } from '../../../utils/mergeDeep';\nvar makeEmptyMessageInputState = function () { return ({\n    attachments: [],\n    fileOrder: [],\n    fileUploads: {},\n    imageOrder: [],\n    imageUploads: {},\n    linkPreviews: new Map(),\n    mentioned_users: [],\n    setText: function () { return null; },\n    text: '',\n}); };\n/**\n * Initializes the state. Empty if the message prop is falsy.\n */\nvar initState = function (message) {\n    var _a, _b, _c, _d, _e, _f, _g;\n    if (!message) {\n        return makeEmptyMessageInputState();\n    }\n    // if message prop is defined, get image uploads, file uploads, text, etc.\n    var imageUploads = (_b = (_a = message.attachments) === null || _a === void 0 ? void 0 : _a.filter(function (_a) {\n        var type = _a.type;\n        return type === 'image';\n    }).reduce(function (acc, _a) {\n        var author_name = _a.author_name, _b = _a.fallback, fallback = _b === void 0 ? '' : _b, image_url = _a.image_url, og_scrape_url = _a.og_scrape_url, text = _a.text, title = _a.title, title_link = _a.title_link;\n        var id = nanoid();\n        acc[id] = {\n            author_name: author_name,\n            file: {\n                name: fallback,\n            },\n            id: id,\n            og_scrape_url: og_scrape_url,\n            state: 'finished',\n            text: text,\n            title: title,\n            title_link: title_link,\n            url: image_url,\n        };\n        return acc;\n    }, {})) !== null && _b !== void 0 ? _b : {};\n    var fileUploads = (_d = (_c = message.attachments) === null || _c === void 0 ? void 0 : _c.filter(function (_a) {\n        var type = _a.type;\n        return type === 'file';\n    }).reduce(function (acc, _a) {\n        var asset_url = _a.asset_url, file_size = _a.file_size, mime_type = _a.mime_type, thumb_url = _a.thumb_url, _b = _a.title, title = _b === void 0 ? '' : _b;\n        var id = nanoid();\n        acc[id] = {\n            file: {\n                name: title,\n                size: file_size,\n                type: mime_type,\n            },\n            id: id,\n            state: 'finished',\n            thumb_url: thumb_url,\n            url: asset_url,\n        };\n        return acc;\n    }, {})) !== null && _d !== void 0 ? _d : {};\n    var linkPreviews = (_f = (_e = message.attachments) === null || _e === void 0 ? void 0 : _e.reduce(function (acc, attachment) {\n        if (!attachment.og_scrape_url)\n            return acc;\n        acc.set(attachment.og_scrape_url, __assign(__assign({}, attachment), { state: LinkPreviewState.LOADED }));\n        return acc;\n    }, new Map())) !== null && _f !== void 0 ? _f : new Map();\n    var imageOrder = Object.keys(imageUploads);\n    var fileOrder = Object.keys(fileUploads);\n    var attachments = ((_g = message.attachments) === null || _g === void 0 ? void 0 : _g.filter(function (_a) {\n        var type = _a.type;\n        return type !== 'file' && type !== 'image';\n    }).map(function (att) {\n        return (__assign(__assign({}, att), { $internal: { id: nanoid(), uploadState: 'finished' } }));\n    })) || [];\n    var mentioned_users = message.mentioned_users || [];\n    return {\n        attachments: attachments,\n        fileOrder: fileOrder,\n        fileUploads: fileUploads,\n        imageOrder: imageOrder,\n        imageUploads: imageUploads,\n        linkPreviews: linkPreviews,\n        mentioned_users: mentioned_users,\n        setText: function () { return null; },\n        text: message.text || '',\n    };\n};\n/**\n * MessageInput state reducer\n */\nvar messageInputReducer = function (state, action) {\n    var _a, _b;\n    var _c;\n    switch (action.type) {\n        case 'setText':\n            return __assign(__assign({}, state), { text: action.getNewText(state.text) });\n        case 'clear':\n            return makeEmptyMessageInputState();\n        case 'upsertAttachment': {\n            var attachmentIndex = state.attachments.findIndex(function (att) { var _a, _b, _c; return ((_a = att.$internal) === null || _a === void 0 ? void 0 : _a.id) && ((_b = att.$internal) === null || _b === void 0 ? void 0 : _b.id) === ((_c = action.attachment.$internal) === null || _c === void 0 ? void 0 : _c.id); });\n            var upsertedAttachment = mergeDeep((_c = state.attachments[attachmentIndex]) !== null && _c !== void 0 ? _c : {}, action.attachment);\n            var attachments = __spreadArray([], state.attachments, true);\n            attachments.splice(attachmentIndex, 1, upsertedAttachment);\n            return __assign(__assign({}, state), { attachments: attachments });\n        }\n        case 'removeAttachment': {\n            var attachmentIndex = state.attachments.findIndex(function (att) { var _a, _b; return ((_a = att.$internal) === null || _a === void 0 ? void 0 : _a.id) && ((_b = att.$internal) === null || _b === void 0 ? void 0 : _b.id) === action.id; });\n            if (attachmentIndex === -1)\n                return state;\n            return __assign(__assign({}, state), { attachments: __spreadArray([], state.attachments.splice(attachmentIndex, 1), true) });\n        }\n        case 'setImageUpload': {\n            var imageAlreadyExists = state.imageUploads[action.id];\n            if (!imageAlreadyExists && !action.file)\n                return state;\n            var imageOrder = imageAlreadyExists ? state.imageOrder : state.imageOrder.concat(action.id);\n            var newUploadFields = __assign({}, action);\n            delete newUploadFields.type;\n            return __assign(__assign({}, state), { imageOrder: imageOrder, imageUploads: __assign(__assign({}, state.imageUploads), (_a = {}, _a[action.id] = __assign(__assign({}, state.imageUploads[action.id]), newUploadFields), _a)) });\n        }\n        case 'setFileUpload': {\n            var fileAlreadyExists = state.fileUploads[action.id];\n            if (!fileAlreadyExists && !action.file)\n                return state;\n            var fileOrder = fileAlreadyExists ? state.fileOrder : state.fileOrder.concat(action.id);\n            var newUploadFields = __assign({}, action);\n            delete newUploadFields.type;\n            return __assign(__assign({}, state), { fileOrder: fileOrder, fileUploads: __assign(__assign({}, state.fileUploads), (_b = {}, _b[action.id] = __assign(__assign({}, state.fileUploads[action.id]), newUploadFields), _b)) });\n        }\n        case 'setLinkPreviews': {\n            var linkPreviews_1 = new Map(state.linkPreviews);\n            if (action.mode === SetLinkPreviewMode.REMOVE) {\n                Array.from(action.linkPreviews.keys()).forEach(function (key) {\n                    linkPreviews_1.delete(key);\n                });\n            }\n            else {\n                Array.from(action.linkPreviews.values()).reduce(function (acc, linkPreview) {\n                    var existingPreview = acc.get(linkPreview.og_scrape_url);\n                    var alreadyEnqueued = linkPreview.state === LinkPreviewState.QUEUED &&\n                        (existingPreview === null || existingPreview === void 0 ? void 0 : existingPreview.state) !== LinkPreviewState.FAILED;\n                    if (existingPreview && alreadyEnqueued)\n                        return acc;\n                    acc.set(linkPreview.og_scrape_url, linkPreview);\n                    return acc;\n                }, linkPreviews_1);\n                if (action.mode === SetLinkPreviewMode.SET) {\n                    Array.from(state.linkPreviews.keys()).forEach(function (key) {\n                        if (!action.linkPreviews.get(key))\n                            linkPreviews_1.delete(key);\n                    });\n                }\n            }\n            return __assign(__assign({}, state), { linkPreviews: linkPreviews_1 });\n        }\n        case 'removeImageUpload': {\n            if (!state.imageUploads[action.id])\n                return state; // cannot remove anything\n            var newImageUploads = __assign({}, state.imageUploads);\n            delete newImageUploads[action.id];\n            return __assign(__assign({}, state), { imageOrder: state.imageOrder.filter(function (_id) { return _id !== action.id; }), imageUploads: newImageUploads });\n        }\n        case 'removeFileUpload': {\n            if (!state.fileUploads[action.id])\n                return state; // cannot remove anything\n            var newFileUploads = __assign({}, state.fileUploads);\n            delete newFileUploads[action.id];\n            return __assign(__assign({}, state), { fileOrder: state.fileOrder.filter(function (_id) { return _id !== action.id; }), fileUploads: newFileUploads });\n        }\n        case 'addMentionedUser':\n            return __assign(__assign({}, state), { mentioned_users: state.mentioned_users.concat(action.user) });\n        default:\n            return state;\n    }\n};\n/**\n * hook for MessageInput state\n */\nexport var useMessageInputState = function (props) {\n    var _a;\n    var additionalTextareaProps = props.additionalTextareaProps, asyncMessagesMultiSendEnabled = props.asyncMessagesMultiSendEnabled, audioRecordingConfig = props.audioRecordingConfig, audioRecordingEnabled = props.audioRecordingEnabled, getDefaultValue = props.getDefaultValue, message = props.message, urlEnrichmentConfig = props.urlEnrichmentConfig;\n    var _b = useChannelStateContext('useMessageInputState'), _c = _b.channelCapabilities, channelCapabilities = _c === void 0 ? {} : _c, channelConfig = _b.channelConfig, enrichURLForPreviewChannelContext = _b.enrichURLForPreview;\n    var defaultValue = (getDefaultValue === null || getDefaultValue === void 0 ? void 0 : getDefaultValue()) || (additionalTextareaProps === null || additionalTextareaProps === void 0 ? void 0 : additionalTextareaProps.defaultValue);\n    var initialStateValue = message ||\n        (Array.isArray(defaultValue)\n            ? { text: defaultValue.join('') }\n            : { text: defaultValue === null || defaultValue === void 0 ? void 0 : defaultValue.toString() });\n    var _d = useReducer(messageInputReducer, initialStateValue, initState), state = _d[0], dispatch = _d[1];\n    var enrichURLsController = useLinkPreviews(__assign(__assign({ dispatch: dispatch, linkPreviews: state.linkPreviews }, urlEnrichmentConfig), { enrichURLForPreview: (_a = urlEnrichmentConfig === null || urlEnrichmentConfig === void 0 ? void 0 : urlEnrichmentConfig.enrichURLForPreview) !== null && _a !== void 0 ? _a : enrichURLForPreviewChannelContext }));\n    var _e = useMessageInputText(props, state, dispatch, enrichURLsController.findAndEnqueueURLsToEnrich), handleChange = _e.handleChange, insertText = _e.insertText, textareaRef = _e.textareaRef;\n    var _f = useState(false), showCommandsList = _f[0], setShowCommandsList = _f[1];\n    var _g = useState(false), showMentionsList = _g[0], setShowMentionsList = _g[1];\n    var openCommandsList = function () {\n        dispatch({\n            getNewText: function () { return '/'; },\n            type: 'setText',\n        });\n        setShowCommandsList(true);\n    };\n    var closeCommandsList = function () { return setShowCommandsList(false); };\n    var openMentionsList = function () {\n        dispatch({\n            getNewText: function (currentText) { return currentText + '@'; },\n            type: 'setText',\n        });\n        setShowMentionsList(true);\n    };\n    var closeMentionsList = function () { return setShowMentionsList(false); };\n    var _h = useAttachments(props, state, dispatch, textareaRef), maxFilesLeft = _h.maxFilesLeft, numberOfUploads = _h.numberOfUploads, removeAttachment = _h.removeAttachment, removeFile = _h.removeFile, removeImage = _h.removeImage, uploadAttachment = _h.uploadAttachment, uploadFile = _h.uploadFile, uploadImage = _h.uploadImage, uploadNewFiles = _h.uploadNewFiles;\n    var handleSubmit = useSubmitHandler(props, state, dispatch, numberOfUploads, enrichURLsController).handleSubmit;\n    var recordingController = useMediaRecorder({\n        asyncMessagesMultiSendEnabled: asyncMessagesMultiSendEnabled,\n        enabled: !!audioRecordingEnabled,\n        handleSubmit: handleSubmit,\n        recordingConfig: audioRecordingConfig,\n        uploadAttachment: uploadAttachment,\n    });\n    // todo: remove the check for channelConfig?.uploads\n    var isUploadEnabled = (channelConfig === null || channelConfig === void 0 ? void 0 : channelConfig.uploads) !== false && channelCapabilities['upload-file'] !== false;\n    var onPaste = usePasteHandler(uploadNewFiles, insertText, isUploadEnabled, enrichURLsController.findAndEnqueueURLsToEnrich).onPaste;\n    var onSelectUser = useCallback(function (item) {\n        dispatch({ type: 'addMentionedUser', user: item });\n    }, []);\n    var setText = useCallback(function (text) {\n        dispatch({ getNewText: function () { return text; }, type: 'setText' });\n    }, []);\n    return __assign(__assign(__assign({}, state), enrichURLsController), { closeCommandsList: closeCommandsList, closeMentionsList: closeMentionsList, handleChange: handleChange, handleSubmit: handleSubmit, insertText: insertText, isUploadEnabled: isUploadEnabled, maxFilesLeft: maxFilesLeft, numberOfUploads: numberOfUploads, onPaste: onPaste, onSelectUser: onSelectUser, openCommandsList: openCommandsList, openMentionsList: openMentionsList, recordingController: recordingController, removeAttachment: removeAttachment, removeFile: removeFile, removeImage: removeImage, setText: setText, showCommandsList: showCommandsList, showMentionsList: showMentionsList, textareaRef: textareaRef, uploadAttachment: uploadAttachment, uploadFile: uploadFile, uploadImage: uploadImage, uploadNewFiles: uploadNewFiles });\n};\n"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,aAAa,QAAQ,OAAO;AAC/C,SAASC,WAAW,EAAEC,UAAU,EAAEC,QAAQ,QAAQ,OAAO;AACzD,SAASC,MAAM,QAAQ,QAAQ;AAC/B,SAASC,sBAAsB,QAAQ,sCAAsC;AAC7E,SAASC,cAAc,QAAQ,kBAAkB;AACjD,SAASC,eAAe,QAAQ,mBAAmB;AACnD,SAASC,mBAAmB,QAAQ,uBAAuB;AAC3D,SAASC,gBAAgB,QAAQ,oBAAoB;AACrD,SAASC,eAAe,QAAQ,mBAAmB;AACnD,SAASC,gBAAgB,QAAQ,4CAA4C;AAC7E,SAASC,gBAAgB,EAAEC,kBAAkB,QAAQ,UAAU;AAC/D,SAASC,SAAS,QAAQ,0BAA0B;AACpD,IAAIC,0BAA0B,GAAG,SAAAA,CAAA,EAAY;EAAE,OAAQ;IACnDC,WAAW,EAAE,EAAE;IACfC,SAAS,EAAE,EAAE;IACbC,WAAW,EAAE,CAAC,CAAC;IACfC,UAAU,EAAE,EAAE;IACdC,YAAY,EAAE,CAAC,CAAC;IAChBC,YAAY,EAAE,IAAIC,GAAG,CAAC,CAAC;IACvBC,eAAe,EAAE,EAAE;IACnBC,OAAO,EAAE,SAAAA,CAAA,EAAY;MAAE,OAAO,IAAI;IAAE,CAAC;IACrCC,IAAI,EAAE;EACV,CAAC;AAAG,CAAC;AACL;AACA;AACA;AACA,IAAIC,SAAS,GAAG,SAAAA,CAAUC,OAAO,EAAE;EAC/B,IAAIC,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE;EAC9B,IAAI,CAACP,OAAO,EAAE;IACV,OAAOZ,0BAA0B,CAAC,CAAC;EACvC;EACA;EACA,IAAIK,YAAY,GAAG,CAACS,EAAE,GAAG,CAACD,EAAE,GAAGD,OAAO,CAACX,WAAW,MAAM,IAAI,IAAIY,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACO,MAAM,CAAC,UAAUP,EAAE,EAAE;IAC7G,IAAIQ,IAAI,GAAGR,EAAE,CAACQ,IAAI;IAClB,OAAOA,IAAI,KAAK,OAAO;EAC3B,CAAC,CAAC,CAACC,MAAM,CAAC,UAAUC,GAAG,EAAEV,EAAE,EAAE;IACzB,IAAIW,WAAW,GAAGX,EAAE,CAACW,WAAW;MAAEV,EAAE,GAAGD,EAAE,CAACY,QAAQ;MAAEA,QAAQ,GAAGX,EAAE,KAAK,KAAK,CAAC,GAAG,EAAE,GAAGA,EAAE;MAAEY,SAAS,GAAGb,EAAE,CAACa,SAAS;MAAEC,aAAa,GAAGd,EAAE,CAACc,aAAa;MAAEjB,IAAI,GAAGG,EAAE,CAACH,IAAI;MAAEkB,KAAK,GAAGf,EAAE,CAACe,KAAK;MAAEC,UAAU,GAAGhB,EAAE,CAACgB,UAAU;IAChN,IAAIC,EAAE,GAAGzC,MAAM,CAAC,CAAC;IACjBkC,GAAG,CAACO,EAAE,CAAC,GAAG;MACNN,WAAW,EAAEA,WAAW;MACxBO,IAAI,EAAE;QACFC,IAAI,EAAEP;MACV,CAAC;MACDK,EAAE,EAAEA,EAAE;MACNH,aAAa,EAAEA,aAAa;MAC5BM,KAAK,EAAE,UAAU;MACjBvB,IAAI,EAAEA,IAAI;MACVkB,KAAK,EAAEA,KAAK;MACZC,UAAU,EAAEA,UAAU;MACtBK,GAAG,EAAER;IACT,CAAC;IACD,OAAOH,GAAG;EACd,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,IAAI,IAAIT,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,CAAC,CAAC;EAC3C,IAAIX,WAAW,GAAG,CAACa,EAAE,GAAG,CAACD,EAAE,GAAGH,OAAO,CAACX,WAAW,MAAM,IAAI,IAAIc,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACK,MAAM,CAAC,UAAUP,EAAE,EAAE;IAC5G,IAAIQ,IAAI,GAAGR,EAAE,CAACQ,IAAI;IAClB,OAAOA,IAAI,KAAK,MAAM;EAC1B,CAAC,CAAC,CAACC,MAAM,CAAC,UAAUC,GAAG,EAAEV,EAAE,EAAE;IACzB,IAAIsB,SAAS,GAAGtB,EAAE,CAACsB,SAAS;MAAEC,SAAS,GAAGvB,EAAE,CAACuB,SAAS;MAAEC,SAAS,GAAGxB,EAAE,CAACwB,SAAS;MAAEC,SAAS,GAAGzB,EAAE,CAACyB,SAAS;MAAExB,EAAE,GAAGD,EAAE,CAACe,KAAK;MAAEA,KAAK,GAAGd,EAAE,KAAK,KAAK,CAAC,GAAG,EAAE,GAAGA,EAAE;IAC1J,IAAIgB,EAAE,GAAGzC,MAAM,CAAC,CAAC;IACjBkC,GAAG,CAACO,EAAE,CAAC,GAAG;MACNC,IAAI,EAAE;QACFC,IAAI,EAAEJ,KAAK;QACXW,IAAI,EAAEH,SAAS;QACff,IAAI,EAAEgB;MACV,CAAC;MACDP,EAAE,EAAEA,EAAE;MACNG,KAAK,EAAE,UAAU;MACjBK,SAAS,EAAEA,SAAS;MACpBJ,GAAG,EAAEC;IACT,CAAC;IACD,OAAOZ,GAAG;EACd,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,IAAI,IAAIP,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,CAAC,CAAC;EAC3C,IAAIV,YAAY,GAAG,CAACY,EAAE,GAAG,CAACD,EAAE,GAAGL,OAAO,CAACX,WAAW,MAAM,IAAI,IAAIgB,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACK,MAAM,CAAC,UAAUC,GAAG,EAAEiB,UAAU,EAAE;IAC1H,IAAI,CAACA,UAAU,CAACb,aAAa,EACzB,OAAOJ,GAAG;IACdA,GAAG,CAACkB,GAAG,CAACD,UAAU,CAACb,aAAa,EAAE3C,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEwD,UAAU,CAAC,EAAE;MAAEP,KAAK,EAAEpC,gBAAgB,CAAC6C;IAAO,CAAC,CAAC,CAAC;IACzG,OAAOnB,GAAG;EACd,CAAC,EAAE,IAAIhB,GAAG,CAAC,CAAC,CAAC,MAAM,IAAI,IAAIW,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,IAAIX,GAAG,CAAC,CAAC;EACzD,IAAIH,UAAU,GAAGuC,MAAM,CAACC,IAAI,CAACvC,YAAY,CAAC;EAC1C,IAAIH,SAAS,GAAGyC,MAAM,CAACC,IAAI,CAACzC,WAAW,CAAC;EACxC,IAAIF,WAAW,GAAG,CAAC,CAACkB,EAAE,GAAGP,OAAO,CAACX,WAAW,MAAM,IAAI,IAAIkB,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACC,MAAM,CAAC,UAAUP,EAAE,EAAE;IACvG,IAAIQ,IAAI,GAAGR,EAAE,CAACQ,IAAI;IAClB,OAAOA,IAAI,KAAK,MAAM,IAAIA,IAAI,KAAK,OAAO;EAC9C,CAAC,CAAC,CAACwB,GAAG,CAAC,UAAUC,GAAG,EAAE;IAClB,OAAQ9D,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAE8D,GAAG,CAAC,EAAE;MAAEC,SAAS,EAAE;QAAEjB,EAAE,EAAEzC,MAAM,CAAC,CAAC;QAAE2D,WAAW,EAAE;MAAW;IAAE,CAAC,CAAC;EACjG,CAAC,CAAC,KAAK,EAAE;EACT,IAAIxC,eAAe,GAAGI,OAAO,CAACJ,eAAe,IAAI,EAAE;EACnD,OAAO;IACHP,WAAW,EAAEA,WAAW;IACxBC,SAAS,EAAEA,SAAS;IACpBC,WAAW,EAAEA,WAAW;IACxBC,UAAU,EAAEA,UAAU;IACtBC,YAAY,EAAEA,YAAY;IAC1BC,YAAY,EAAEA,YAAY;IAC1BE,eAAe,EAAEA,eAAe;IAChCC,OAAO,EAAE,SAAAA,CAAA,EAAY;MAAE,OAAO,IAAI;IAAE,CAAC;IACrCC,IAAI,EAAEE,OAAO,CAACF,IAAI,IAAI;EAC1B,CAAC;AACL,CAAC;AACD;AACA;AACA;AACA,IAAIuC,mBAAmB,GAAG,SAAAA,CAAUhB,KAAK,EAAEiB,MAAM,EAAE;EAC/C,IAAIrC,EAAE,EAAEC,EAAE;EACV,IAAIC,EAAE;EACN,QAAQmC,MAAM,CAAC7B,IAAI;IACf,KAAK,SAAS;MACV,OAAOrC,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC,EAAE;QAAEvB,IAAI,EAAEwC,MAAM,CAACC,UAAU,CAAClB,KAAK,CAACvB,IAAI;MAAE,CAAC,CAAC;IACjF,KAAK,OAAO;MACR,OAAOV,0BAA0B,CAAC,CAAC;IACvC,KAAK,kBAAkB;MAAE;QACrB,IAAIoD,eAAe,GAAGnB,KAAK,CAAChC,WAAW,CAACoD,SAAS,CAAC,UAAUP,GAAG,EAAE;UAAE,IAAIjC,EAAE,EAAEC,EAAE,EAAEC,EAAE;UAAE,OAAO,CAAC,CAACF,EAAE,GAAGiC,GAAG,CAACC,SAAS,MAAM,IAAI,IAAIlC,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACiB,EAAE,KAAK,CAAC,CAAChB,EAAE,GAAGgC,GAAG,CAACC,SAAS,MAAM,IAAI,IAAIjC,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACgB,EAAE,OAAO,CAACf,EAAE,GAAGmC,MAAM,CAACV,UAAU,CAACO,SAAS,MAAM,IAAI,IAAIhC,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACe,EAAE,CAAC;QAAE,CAAC,CAAC;QACxT,IAAIwB,kBAAkB,GAAGvD,SAAS,CAAC,CAACgB,EAAE,GAAGkB,KAAK,CAAChC,WAAW,CAACmD,eAAe,CAAC,MAAM,IAAI,IAAIrC,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG,CAAC,CAAC,EAAEmC,MAAM,CAACV,UAAU,CAAC;QACpI,IAAIvC,WAAW,GAAGhB,aAAa,CAAC,EAAE,EAAEgD,KAAK,CAAChC,WAAW,EAAE,IAAI,CAAC;QAC5DA,WAAW,CAACsD,MAAM,CAACH,eAAe,EAAE,CAAC,EAAEE,kBAAkB,CAAC;QAC1D,OAAOtE,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC,EAAE;UAAEhC,WAAW,EAAEA;QAAY,CAAC,CAAC;MACtE;IACA,KAAK,kBAAkB;MAAE;QACrB,IAAImD,eAAe,GAAGnB,KAAK,CAAChC,WAAW,CAACoD,SAAS,CAAC,UAAUP,GAAG,EAAE;UAAE,IAAIjC,EAAE,EAAEC,EAAE;UAAE,OAAO,CAAC,CAACD,EAAE,GAAGiC,GAAG,CAACC,SAAS,MAAM,IAAI,IAAIlC,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACiB,EAAE,KAAK,CAAC,CAAChB,EAAE,GAAGgC,GAAG,CAACC,SAAS,MAAM,IAAI,IAAIjC,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACgB,EAAE,MAAMoB,MAAM,CAACpB,EAAE;QAAE,CAAC,CAAC;QAC9O,IAAIsB,eAAe,KAAK,CAAC,CAAC,EACtB,OAAOnB,KAAK;QAChB,OAAOjD,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC,EAAE;UAAEhC,WAAW,EAAEhB,aAAa,CAAC,EAAE,EAAEgD,KAAK,CAAChC,WAAW,CAACsD,MAAM,CAACH,eAAe,EAAE,CAAC,CAAC,EAAE,IAAI;QAAE,CAAC,CAAC;MAChI;IACA,KAAK,gBAAgB;MAAE;QACnB,IAAII,kBAAkB,GAAGvB,KAAK,CAAC5B,YAAY,CAAC6C,MAAM,CAACpB,EAAE,CAAC;QACtD,IAAI,CAAC0B,kBAAkB,IAAI,CAACN,MAAM,CAACnB,IAAI,EACnC,OAAOE,KAAK;QAChB,IAAI7B,UAAU,GAAGoD,kBAAkB,GAAGvB,KAAK,CAAC7B,UAAU,GAAG6B,KAAK,CAAC7B,UAAU,CAACqD,MAAM,CAACP,MAAM,CAACpB,EAAE,CAAC;QAC3F,IAAI4B,eAAe,GAAG1E,QAAQ,CAAC,CAAC,CAAC,EAAEkE,MAAM,CAAC;QAC1C,OAAOQ,eAAe,CAACrC,IAAI;QAC3B,OAAOrC,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC,EAAE;UAAE7B,UAAU,EAAEA,UAAU;UAAEC,YAAY,EAAErB,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC5B,YAAY,CAAC,GAAGQ,EAAE,GAAG,CAAC,CAAC,EAAEA,EAAE,CAACqC,MAAM,CAACpB,EAAE,CAAC,GAAG9C,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC5B,YAAY,CAAC6C,MAAM,CAACpB,EAAE,CAAC,CAAC,EAAE4B,eAAe,CAAC,EAAE7C,EAAE,CAAC;QAAE,CAAC,CAAC;MACrO;IACA,KAAK,eAAe;MAAE;QAClB,IAAI8C,iBAAiB,GAAG1B,KAAK,CAAC9B,WAAW,CAAC+C,MAAM,CAACpB,EAAE,CAAC;QACpD,IAAI,CAAC6B,iBAAiB,IAAI,CAACT,MAAM,CAACnB,IAAI,EAClC,OAAOE,KAAK;QAChB,IAAI/B,SAAS,GAAGyD,iBAAiB,GAAG1B,KAAK,CAAC/B,SAAS,GAAG+B,KAAK,CAAC/B,SAAS,CAACuD,MAAM,CAACP,MAAM,CAACpB,EAAE,CAAC;QACvF,IAAI4B,eAAe,GAAG1E,QAAQ,CAAC,CAAC,CAAC,EAAEkE,MAAM,CAAC;QAC1C,OAAOQ,eAAe,CAACrC,IAAI;QAC3B,OAAOrC,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC,EAAE;UAAE/B,SAAS,EAAEA,SAAS;UAAEC,WAAW,EAAEnB,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC9B,WAAW,CAAC,GAAGW,EAAE,GAAG,CAAC,CAAC,EAAEA,EAAE,CAACoC,MAAM,CAACpB,EAAE,CAAC,GAAG9C,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC9B,WAAW,CAAC+C,MAAM,CAACpB,EAAE,CAAC,CAAC,EAAE4B,eAAe,CAAC,EAAE5C,EAAE,CAAC;QAAE,CAAC,CAAC;MAChO;IACA,KAAK,iBAAiB;MAAE;QACpB,IAAI8C,cAAc,GAAG,IAAIrD,GAAG,CAAC0B,KAAK,CAAC3B,YAAY,CAAC;QAChD,IAAI4C,MAAM,CAACW,IAAI,KAAK/D,kBAAkB,CAACgE,MAAM,EAAE;UAC3CC,KAAK,CAACC,IAAI,CAACd,MAAM,CAAC5C,YAAY,CAACsC,IAAI,CAAC,CAAC,CAAC,CAACqB,OAAO,CAAC,UAAUC,GAAG,EAAE;YAC1DN,cAAc,CAACO,MAAM,CAACD,GAAG,CAAC;UAC9B,CAAC,CAAC;QACN,CAAC,MACI;UACDH,KAAK,CAACC,IAAI,CAACd,MAAM,CAAC5C,YAAY,CAAC8D,MAAM,CAAC,CAAC,CAAC,CAAC9C,MAAM,CAAC,UAAUC,GAAG,EAAE8C,WAAW,EAAE;YACxE,IAAIC,eAAe,GAAG/C,GAAG,CAACgD,GAAG,CAACF,WAAW,CAAC1C,aAAa,CAAC;YACxD,IAAI6C,eAAe,GAAGH,WAAW,CAACpC,KAAK,KAAKpC,gBAAgB,CAAC4E,MAAM,IAC/D,CAACH,eAAe,KAAK,IAAI,IAAIA,eAAe,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,eAAe,CAACrC,KAAK,MAAMpC,gBAAgB,CAAC6E,MAAM;YACzH,IAAIJ,eAAe,IAAIE,eAAe,EAClC,OAAOjD,GAAG;YACdA,GAAG,CAACkB,GAAG,CAAC4B,WAAW,CAAC1C,aAAa,EAAE0C,WAAW,CAAC;YAC/C,OAAO9C,GAAG;UACd,CAAC,EAAEqC,cAAc,CAAC;UAClB,IAAIV,MAAM,CAACW,IAAI,KAAK/D,kBAAkB,CAAC6E,GAAG,EAAE;YACxCZ,KAAK,CAACC,IAAI,CAAC/B,KAAK,CAAC3B,YAAY,CAACsC,IAAI,CAAC,CAAC,CAAC,CAACqB,OAAO,CAAC,UAAUC,GAAG,EAAE;cACzD,IAAI,CAAChB,MAAM,CAAC5C,YAAY,CAACiE,GAAG,CAACL,GAAG,CAAC,EAC7BN,cAAc,CAACO,MAAM,CAACD,GAAG,CAAC;YAClC,CAAC,CAAC;UACN;QACJ;QACA,OAAOlF,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC,EAAE;UAAE3B,YAAY,EAAEsD;QAAe,CAAC,CAAC;MAC1E;IACA,KAAK,mBAAmB;MAAE;QACtB,IAAI,CAAC3B,KAAK,CAAC5B,YAAY,CAAC6C,MAAM,CAACpB,EAAE,CAAC,EAC9B,OAAOG,KAAK,CAAC,CAAC;QAClB,IAAI2C,eAAe,GAAG5F,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC5B,YAAY,CAAC;QACtD,OAAOuE,eAAe,CAAC1B,MAAM,CAACpB,EAAE,CAAC;QACjC,OAAO9C,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC,EAAE;UAAE7B,UAAU,EAAE6B,KAAK,CAAC7B,UAAU,CAACgB,MAAM,CAAC,UAAUyD,GAAG,EAAE;YAAE,OAAOA,GAAG,KAAK3B,MAAM,CAACpB,EAAE;UAAE,CAAC,CAAC;UAAEzB,YAAY,EAAEuE;QAAgB,CAAC,CAAC;MAC9J;IACA,KAAK,kBAAkB;MAAE;QACrB,IAAI,CAAC3C,KAAK,CAAC9B,WAAW,CAAC+C,MAAM,CAACpB,EAAE,CAAC,EAC7B,OAAOG,KAAK,CAAC,CAAC;QAClB,IAAI6C,cAAc,GAAG9F,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC9B,WAAW,CAAC;QACpD,OAAO2E,cAAc,CAAC5B,MAAM,CAACpB,EAAE,CAAC;QAChC,OAAO9C,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC,EAAE;UAAE/B,SAAS,EAAE+B,KAAK,CAAC/B,SAAS,CAACkB,MAAM,CAAC,UAAUyD,GAAG,EAAE;YAAE,OAAOA,GAAG,KAAK3B,MAAM,CAACpB,EAAE;UAAE,CAAC,CAAC;UAAE3B,WAAW,EAAE2E;QAAe,CAAC,CAAC;MAC1J;IACA,KAAK,kBAAkB;MACnB,OAAO9F,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC,EAAE;QAAEzB,eAAe,EAAEyB,KAAK,CAACzB,eAAe,CAACiD,MAAM,CAACP,MAAM,CAAC6B,IAAI;MAAE,CAAC,CAAC;IACxG;MACI,OAAO9C,KAAK;EACpB;AACJ,CAAC;AACD;AACA;AACA;AACA,OAAO,IAAI+C,oBAAoB,GAAG,SAAAA,CAAUC,KAAK,EAAE;EAC/C,IAAIpE,EAAE;EACN,IAAIqE,uBAAuB,GAAGD,KAAK,CAACC,uBAAuB;IAAEC,6BAA6B,GAAGF,KAAK,CAACE,6BAA6B;IAAEC,oBAAoB,GAAGH,KAAK,CAACG,oBAAoB;IAAEC,qBAAqB,GAAGJ,KAAK,CAACI,qBAAqB;IAAEC,eAAe,GAAGL,KAAK,CAACK,eAAe;IAAE1E,OAAO,GAAGqE,KAAK,CAACrE,OAAO;IAAE2E,mBAAmB,GAAGN,KAAK,CAACM,mBAAmB;EAC3V,IAAIzE,EAAE,GAAGxB,sBAAsB,CAAC,sBAAsB,CAAC;IAAEyB,EAAE,GAAGD,EAAE,CAAC0E,mBAAmB;IAAEA,mBAAmB,GAAGzE,EAAE,KAAK,KAAK,CAAC,GAAG,CAAC,CAAC,GAAGA,EAAE;IAAE0E,aAAa,GAAG3E,EAAE,CAAC2E,aAAa;IAAEC,iCAAiC,GAAG5E,EAAE,CAAC6E,mBAAmB;EACjO,IAAIC,YAAY,GAAG,CAACN,eAAe,KAAK,IAAI,IAAIA,eAAe,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,eAAe,CAAC,CAAC,MAAMJ,uBAAuB,KAAK,IAAI,IAAIA,uBAAuB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,uBAAuB,CAACU,YAAY,CAAC;EACpO,IAAIC,iBAAiB,GAAGjF,OAAO,KAC1BmD,KAAK,CAAC+B,OAAO,CAACF,YAAY,CAAC,GACtB;IAAElF,IAAI,EAAEkF,YAAY,CAACG,IAAI,CAAC,EAAE;EAAE,CAAC,GAC/B;IAAErF,IAAI,EAAEkF,YAAY,KAAK,IAAI,IAAIA,YAAY,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,YAAY,CAACI,QAAQ,CAAC;EAAE,CAAC,CAAC;EACxG,IAAIhF,EAAE,GAAG7B,UAAU,CAAC8D,mBAAmB,EAAE4C,iBAAiB,EAAElF,SAAS,CAAC;IAAEsB,KAAK,GAAGjB,EAAE,CAAC,CAAC,CAAC;IAAEiF,QAAQ,GAAGjF,EAAE,CAAC,CAAC,CAAC;EACvG,IAAIkF,oBAAoB,GAAG1G,eAAe,CAACR,QAAQ,CAACA,QAAQ,CAAC;IAAEiH,QAAQ,EAAEA,QAAQ;IAAE3F,YAAY,EAAE2B,KAAK,CAAC3B;EAAa,CAAC,EAAEiF,mBAAmB,CAAC,EAAE;IAAEI,mBAAmB,EAAE,CAAC9E,EAAE,GAAG0E,mBAAmB,KAAK,IAAI,IAAIA,mBAAmB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,mBAAmB,CAACI,mBAAmB,MAAM,IAAI,IAAI9E,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAG6E;EAAkC,CAAC,CAAC,CAAC;EACnW,IAAIzE,EAAE,GAAGxB,mBAAmB,CAACwF,KAAK,EAAEhD,KAAK,EAAEgE,QAAQ,EAAEC,oBAAoB,CAACC,0BAA0B,CAAC;IAAEC,YAAY,GAAGnF,EAAE,CAACmF,YAAY;IAAEC,UAAU,GAAGpF,EAAE,CAACoF,UAAU;IAAEC,WAAW,GAAGrF,EAAE,CAACqF,WAAW;EAC/L,IAAIpF,EAAE,GAAG9B,QAAQ,CAAC,KAAK,CAAC;IAAEmH,gBAAgB,GAAGrF,EAAE,CAAC,CAAC,CAAC;IAAEsF,mBAAmB,GAAGtF,EAAE,CAAC,CAAC,CAAC;EAC/E,IAAIC,EAAE,GAAG/B,QAAQ,CAAC,KAAK,CAAC;IAAEqH,gBAAgB,GAAGtF,EAAE,CAAC,CAAC,CAAC;IAAEuF,mBAAmB,GAAGvF,EAAE,CAAC,CAAC,CAAC;EAC/E,IAAIwF,gBAAgB,GAAG,SAAAA,CAAA,EAAY;IAC/BV,QAAQ,CAAC;MACL9C,UAAU,EAAE,SAAAA,CAAA,EAAY;QAAE,OAAO,GAAG;MAAE,CAAC;MACvC9B,IAAI,EAAE;IACV,CAAC,CAAC;IACFmF,mBAAmB,CAAC,IAAI,CAAC;EAC7B,CAAC;EACD,IAAII,iBAAiB,GAAG,SAAAA,CAAA,EAAY;IAAE,OAAOJ,mBAAmB,CAAC,KAAK,CAAC;EAAE,CAAC;EAC1E,IAAIK,gBAAgB,GAAG,SAAAA,CAAA,EAAY;IAC/BZ,QAAQ,CAAC;MACL9C,UAAU,EAAE,SAAAA,CAAU2D,WAAW,EAAE;QAAE,OAAOA,WAAW,GAAG,GAAG;MAAE,CAAC;MAChEzF,IAAI,EAAE;IACV,CAAC,CAAC;IACFqF,mBAAmB,CAAC,IAAI,CAAC;EAC7B,CAAC;EACD,IAAIK,iBAAiB,GAAG,SAAAA,CAAA,EAAY;IAAE,OAAOL,mBAAmB,CAAC,KAAK,CAAC;EAAE,CAAC;EAC1E,IAAIM,EAAE,GAAGzH,cAAc,CAAC0F,KAAK,EAAEhD,KAAK,EAAEgE,QAAQ,EAAEK,WAAW,CAAC;IAAEW,YAAY,GAAGD,EAAE,CAACC,YAAY;IAAEC,eAAe,GAAGF,EAAE,CAACE,eAAe;IAAEC,gBAAgB,GAAGH,EAAE,CAACG,gBAAgB;IAAEC,UAAU,GAAGJ,EAAE,CAACI,UAAU;IAAEC,WAAW,GAAGL,EAAE,CAACK,WAAW;IAAEC,gBAAgB,GAAGN,EAAE,CAACM,gBAAgB;IAAEC,UAAU,GAAGP,EAAE,CAACO,UAAU;IAAEC,WAAW,GAAGR,EAAE,CAACQ,WAAW;IAAEC,cAAc,GAAGT,EAAE,CAACS,cAAc;EAC1W,IAAIC,YAAY,GAAGhI,gBAAgB,CAACuF,KAAK,EAAEhD,KAAK,EAAEgE,QAAQ,EAAEiB,eAAe,EAAEhB,oBAAoB,CAAC,CAACwB,YAAY;EAC/G,IAAIC,mBAAmB,GAAG/H,gBAAgB,CAAC;IACvCuF,6BAA6B,EAAEA,6BAA6B;IAC5DyC,OAAO,EAAE,CAAC,CAACvC,qBAAqB;IAChCqC,YAAY,EAAEA,YAAY;IAC1BG,eAAe,EAAEzC,oBAAoB;IACrCkC,gBAAgB,EAAEA;EACtB,CAAC,CAAC;EACF;EACA,IAAIQ,eAAe,GAAG,CAACrC,aAAa,KAAK,IAAI,IAAIA,aAAa,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,aAAa,CAACsC,OAAO,MAAM,KAAK,IAAIvC,mBAAmB,CAAC,aAAa,CAAC,KAAK,KAAK;EACrK,IAAIwC,OAAO,GAAGrI,eAAe,CAAC8H,cAAc,EAAEpB,UAAU,EAAEyB,eAAe,EAAE5B,oBAAoB,CAACC,0BAA0B,CAAC,CAAC6B,OAAO;EACnI,IAAIC,YAAY,GAAG/I,WAAW,CAAC,UAAUgJ,IAAI,EAAE;IAC3CjC,QAAQ,CAAC;MAAE5E,IAAI,EAAE,kBAAkB;MAAE0D,IAAI,EAAEmD;IAAK,CAAC,CAAC;EACtD,CAAC,EAAE,EAAE,CAAC;EACN,IAAIzH,OAAO,GAAGvB,WAAW,CAAC,UAAUwB,IAAI,EAAE;IACtCuF,QAAQ,CAAC;MAAE9C,UAAU,EAAE,SAAAA,CAAA,EAAY;QAAE,OAAOzC,IAAI;MAAE,CAAC;MAAEW,IAAI,EAAE;IAAU,CAAC,CAAC;EAC3E,CAAC,EAAE,EAAE,CAAC;EACN,OAAOrC,QAAQ,CAACA,QAAQ,CAACA,QAAQ,CAAC,CAAC,CAAC,EAAEiD,KAAK,CAAC,EAAEiE,oBAAoB,CAAC,EAAE;IAAEU,iBAAiB,EAAEA,iBAAiB;IAAEG,iBAAiB,EAAEA,iBAAiB;IAAEX,YAAY,EAAEA,YAAY;IAAEsB,YAAY,EAAEA,YAAY;IAAErB,UAAU,EAAEA,UAAU;IAAEyB,eAAe,EAAEA,eAAe;IAAEb,YAAY,EAAEA,YAAY;IAAEC,eAAe,EAAEA,eAAe;IAAEc,OAAO,EAAEA,OAAO;IAAEC,YAAY,EAAEA,YAAY;IAAEtB,gBAAgB,EAAEA,gBAAgB;IAAEE,gBAAgB,EAAEA,gBAAgB;IAAEc,mBAAmB,EAAEA,mBAAmB;IAAER,gBAAgB,EAAEA,gBAAgB;IAAEC,UAAU,EAAEA,UAAU;IAAEC,WAAW,EAAEA,WAAW;IAAE5G,OAAO,EAAEA,OAAO;IAAE8F,gBAAgB,EAAEA,gBAAgB;IAAEE,gBAAgB,EAAEA,gBAAgB;IAAEH,WAAW,EAAEA,WAAW;IAAEgB,gBAAgB,EAAEA,gBAAgB;IAAEC,UAAU,EAAEA,UAAU;IAAEC,WAAW,EAAEA,WAAW;IAAEC,cAAc,EAAEA;EAAe,CAAC,CAAC;AACxyB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}