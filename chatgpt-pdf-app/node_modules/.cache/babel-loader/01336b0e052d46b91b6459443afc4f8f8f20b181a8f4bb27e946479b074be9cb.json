{"ast":null,"code":"import { __assign, __spreadArray } from \"tslib\";\nimport { BehaviorSubject } from '../observable/BehaviorSubject';\nimport { Subject } from '../observable/Subject';\nimport { mergeDeepUndefined } from '../../../utils/mergeDeep';\nvar MAX_FREQUENCY_AMPLITUDE = 255;\nvar logError = function (e) {\n  return e && console.error('[AMPLITUDE RECORDER ERROR]', e);\n};\nvar rootMeanSquare = function (values) {\n  return Math.sqrt(values.reduce(function (acc, val) {\n    return acc + Math.pow(val, 2);\n  }, 0) / values.length);\n};\nexport var DEFAULT_AMPLITUDE_RECORDER_CONFIG = {\n  analyserConfig: {\n    fftSize: 32,\n    maxDecibels: 0,\n    minDecibels: -100\n  },\n  sampleCount: 100,\n  samplingFrequencyMs: 60\n};\nexport var AmplitudeRecorderState;\n(function (AmplitudeRecorderState) {\n  AmplitudeRecorderState[\"CLOSED\"] = \"closed\";\n  AmplitudeRecorderState[\"RECORDING\"] = \"recording\";\n  AmplitudeRecorderState[\"STOPPED\"] = \"stopped\";\n})(AmplitudeRecorderState || (AmplitudeRecorderState = {}));\nvar AmplitudeRecorder = /** @class */function () {\n  function AmplitudeRecorder(_a) {\n    var config = _a.config,\n      stream = _a.stream;\n    var _this = this;\n    this.amplitudes = new BehaviorSubject([]);\n    this.state = new BehaviorSubject(undefined);\n    this.error = new Subject();\n    this.start = function () {\n      if (_this.state.value === AmplitudeRecorderState.CLOSED) return;\n      if (!_this.stream) {\n        throw new Error('Missing MediaStream instance. Cannot to start amplitude recording');\n      }\n      if (_this.state.value === AmplitudeRecorderState.RECORDING) _this.stop();\n      if (!_this.analyserNode) {\n        if (!_this.stream) return;\n        _this.init();\n      }\n      _this.state.next(AmplitudeRecorderState.RECORDING);\n      _this.amplitudeSamplingInterval = setInterval(function () {\n        if (!(_this.analyserNode && _this.state.value === AmplitudeRecorderState.RECORDING)) return;\n        var frequencyBins = new Uint8Array(_this.analyserNode.frequencyBinCount);\n        try {\n          _this.analyserNode.getByteFrequencyData(frequencyBins);\n        } catch (e) {\n          logError(e);\n          _this.error.next(e);\n          return;\n        }\n        var normalizedSignalStrength = rootMeanSquare(frequencyBins) / MAX_FREQUENCY_AMPLITUDE;\n        _this.amplitudes.next(__spreadArray(__spreadArray([], _this.amplitudes.value, true), [normalizedSignalStrength], false));\n      }, _this.config.samplingFrequencyMs);\n    };\n    this.config = mergeDeepUndefined(__assign({}, config), DEFAULT_AMPLITUDE_RECORDER_CONFIG);\n    this.stream = stream;\n  }\n  AmplitudeRecorder.prototype.init = function () {\n    this.audioContext = new AudioContext();\n    this.analyserNode = this.audioContext.createAnalyser();\n    var analyserConfig = this.config.analyserConfig;\n    this.analyserNode.fftSize = analyserConfig.fftSize;\n    this.analyserNode.maxDecibels = analyserConfig.maxDecibels;\n    this.analyserNode.minDecibels = analyserConfig.minDecibels;\n    this.microphone = this.audioContext.createMediaStreamSource(this.stream);\n    this.microphone.connect(this.analyserNode);\n  };\n  AmplitudeRecorder.prototype.stop = function () {\n    clearInterval(this.amplitudeSamplingInterval);\n    this.amplitudeSamplingInterval = undefined;\n    this.state.next(AmplitudeRecorderState.STOPPED);\n  };\n  AmplitudeRecorder.prototype.close = function () {\n    var _a, _b, _c, _d;\n    if (this.state.value !== AmplitudeRecorderState.STOPPED) this.stop();\n    this.state.next(AmplitudeRecorderState.CLOSED);\n    this.amplitudes.next([]);\n    (_a = this.microphone) === null || _a === void 0 ? void 0 : _a.disconnect();\n    (_b = this.analyserNode) === null || _b === void 0 ? void 0 : _b.disconnect();\n    if (((_c = this.audioContext) === null || _c === void 0 ? void 0 : _c.state) !== 'closed') (_d = this.audioContext) === null || _d === void 0 ? void 0 : _d.close();\n  };\n  return AmplitudeRecorder;\n}();\nexport { AmplitudeRecorder };","map":{"version":3,"names":["__assign","__spreadArray","BehaviorSubject","Subject","mergeDeepUndefined","MAX_FREQUENCY_AMPLITUDE","logError","e","console","error","rootMeanSquare","values","Math","sqrt","reduce","acc","val","pow","length","DEFAULT_AMPLITUDE_RECORDER_CONFIG","analyserConfig","fftSize","maxDecibels","minDecibels","sampleCount","samplingFrequencyMs","AmplitudeRecorderState","AmplitudeRecorder","_a","config","stream","_this","amplitudes","state","undefined","start","value","CLOSED","Error","RECORDING","stop","analyserNode","init","next","amplitudeSamplingInterval","setInterval","frequencyBins","Uint8Array","frequencyBinCount","getByteFrequencyData","normalizedSignalStrength","prototype","audioContext","AudioContext","createAnalyser","microphone","createMediaStreamSource","connect","clearInterval","STOPPED","close","_b","_c","_d","disconnect"],"sources":["C:/Users/Aniket/Desktop/MS/NCSU/Subjects/Infinitus/chatgpt-pdf-app/node_modules/stream-chat-react/dist/components/MediaRecorder/classes/AmplitudeRecorder.js"],"sourcesContent":["import { __assign, __spreadArray } from \"tslib\";\nimport { BehaviorSubject } from '../observable/BehaviorSubject';\nimport { Subject } from '../observable/Subject';\nimport { mergeDeepUndefined } from '../../../utils/mergeDeep';\nvar MAX_FREQUENCY_AMPLITUDE = 255;\nvar logError = function (e) { return e && console.error('[AMPLITUDE RECORDER ERROR]', e); };\nvar rootMeanSquare = function (values) {\n    return Math.sqrt(values.reduce(function (acc, val) { return acc + Math.pow(val, 2); }, 0) / values.length);\n};\nexport var DEFAULT_AMPLITUDE_RECORDER_CONFIG = {\n    analyserConfig: {\n        fftSize: 32,\n        maxDecibels: 0,\n        minDecibels: -100,\n    },\n    sampleCount: 100,\n    samplingFrequencyMs: 60,\n};\nexport var AmplitudeRecorderState;\n(function (AmplitudeRecorderState) {\n    AmplitudeRecorderState[\"CLOSED\"] = \"closed\";\n    AmplitudeRecorderState[\"RECORDING\"] = \"recording\";\n    AmplitudeRecorderState[\"STOPPED\"] = \"stopped\";\n})(AmplitudeRecorderState || (AmplitudeRecorderState = {}));\nvar AmplitudeRecorder = /** @class */ (function () {\n    function AmplitudeRecorder(_a) {\n        var config = _a.config, stream = _a.stream;\n        var _this = this;\n        this.amplitudes = new BehaviorSubject([]);\n        this.state = new BehaviorSubject(undefined);\n        this.error = new Subject();\n        this.start = function () {\n            if (_this.state.value === AmplitudeRecorderState.CLOSED)\n                return;\n            if (!_this.stream) {\n                throw new Error('Missing MediaStream instance. Cannot to start amplitude recording');\n            }\n            if (_this.state.value === AmplitudeRecorderState.RECORDING)\n                _this.stop();\n            if (!_this.analyserNode) {\n                if (!_this.stream)\n                    return;\n                _this.init();\n            }\n            _this.state.next(AmplitudeRecorderState.RECORDING);\n            _this.amplitudeSamplingInterval = setInterval(function () {\n                if (!(_this.analyserNode && _this.state.value === AmplitudeRecorderState.RECORDING))\n                    return;\n                var frequencyBins = new Uint8Array(_this.analyserNode.frequencyBinCount);\n                try {\n                    _this.analyserNode.getByteFrequencyData(frequencyBins);\n                }\n                catch (e) {\n                    logError(e);\n                    _this.error.next(e);\n                    return;\n                }\n                var normalizedSignalStrength = rootMeanSquare(frequencyBins) / MAX_FREQUENCY_AMPLITUDE;\n                _this.amplitudes.next(__spreadArray(__spreadArray([], _this.amplitudes.value, true), [normalizedSignalStrength], false));\n            }, _this.config.samplingFrequencyMs);\n        };\n        this.config = mergeDeepUndefined(__assign({}, config), DEFAULT_AMPLITUDE_RECORDER_CONFIG);\n        this.stream = stream;\n    }\n    AmplitudeRecorder.prototype.init = function () {\n        this.audioContext = new AudioContext();\n        this.analyserNode = this.audioContext.createAnalyser();\n        var analyserConfig = this.config.analyserConfig;\n        this.analyserNode.fftSize = analyserConfig.fftSize;\n        this.analyserNode.maxDecibels = analyserConfig.maxDecibels;\n        this.analyserNode.minDecibels = analyserConfig.minDecibels;\n        this.microphone = this.audioContext.createMediaStreamSource(this.stream);\n        this.microphone.connect(this.analyserNode);\n    };\n    AmplitudeRecorder.prototype.stop = function () {\n        clearInterval(this.amplitudeSamplingInterval);\n        this.amplitudeSamplingInterval = undefined;\n        this.state.next(AmplitudeRecorderState.STOPPED);\n    };\n    AmplitudeRecorder.prototype.close = function () {\n        var _a, _b, _c, _d;\n        if (this.state.value !== AmplitudeRecorderState.STOPPED)\n            this.stop();\n        this.state.next(AmplitudeRecorderState.CLOSED);\n        this.amplitudes.next([]);\n        (_a = this.microphone) === null || _a === void 0 ? void 0 : _a.disconnect();\n        (_b = this.analyserNode) === null || _b === void 0 ? void 0 : _b.disconnect();\n        if (((_c = this.audioContext) === null || _c === void 0 ? void 0 : _c.state) !== 'closed')\n            (_d = this.audioContext) === null || _d === void 0 ? void 0 : _d.close();\n    };\n    return AmplitudeRecorder;\n}());\nexport { AmplitudeRecorder };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}